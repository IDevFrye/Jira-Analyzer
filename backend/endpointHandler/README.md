# Инструкция к взаимодействию с endpointHandler во время разработки


## Пример файла конфигурации
```yaml
server:
  port: "8000"

database:
  host: "localhost"
  user: "postgres"
  password: "00000"
  dbname: "jira2"
  port: "5432"
  sslmode: "disable"

connector:
  baseURL: "http://localhost:8080/api/v1/connector"
```


## Запуск сервера 


1. Убедитесь в существовании базы данных
2. Для запуска сервиса выполните команду из ./cmd/service
```bash
go run main.go --config="CONFIG FILE PATH"
```
3. Через браузер\curl\postman проверьте работу выполнив один из доступных запросов


## Запросы

1. /api/v1/projects (GET) - получение всех загруженных проектов.


2. /api/v1/projects/{id:[0-9]+} (GET) - получение сухой статистики
   проекта по его ID в БД.


3. /api/v1/projects/{id:[0-9]+} (DELETE) - удаление проекта из БД  по его ID.


4. /api/v1/connector/projects (GET) - для получения проектов, доступных для загрузки.
   Доступны параметры:
- limit: [int] - количество проектов на одной странице (limit > 0)
- page: [int] - номер страницы, с которой необходимо вернуть проекты (page > 0)
- search: [string] - параметр для фильтрации списка проектов. Будут возвращены только те проекты, имя или ключ которых содержат подстроку заданную в этом параметре без учета регистра.


Возвращает JSON, содержащий массив Projects (проекты на странице под номером page) и структуру PageInfo, которая содержит поле PageCount - общее количество страниц при данном параметре limit и search, CurrentPage - номер текущей страницы, ProjectsCount - общее количество проектов при данном параметре search. Значение limit по умолчанию = 20, значение page по умолчанию = 1


5. /api/v1/connector/updateProject?project=projectKey (POST)- Получает (или обновляет) все issues из проекта с ключом 'projectKey' и заносит в базу данных. Что будет происходить - загрузка или
   обновление - зависит от того, был ли проект сохранен локально ранее.


*База данных обновляется только при запросе на update.


6. api/v1/compare/time-open (GET) - получение данных по метрике time-open для нескольких проектов.
   Параметры:
   key - ключи проектов, разделенные запятой.


7. api/v1/compare/status-distribution (GET) - получение данных по метрике status-distribution для нескольких проектов.
   Параметры:
   key - ключи проектов, разделенные запятой.


8. api/v1/compare/time-spent (GET) - получение данных по метрике time-spent для нескольких проектов.
   Параметры:
   key - ключи проектов, разделенные запятой.


9. api/v1/compare/priority (GET) - получение данных по метрике priority для нескольких проектов.
   Параметры:
   key - ключи проектов, разделенные запятой.


9. api/v1/analytics/time-open (GET) - получение данных по метрике time-open для одного проекта.
   Параметры:
   key - ключ проекта.


9. api/v1/analytics/status-distribution (GET) - получение данных по метрике status-distribution для одного проекта.
   Параметры:
   key - ключ проекта.


9. api/v1/analytics/time-spent (GET) - получение данных по метрике time-spent для одного проекта.
   Параметры:
   key - ключ проекта.


9. api/v1/analytics/priority (GET) - получение данных по метрике priority для одного проекта.
   Параметры:
   key - ключ проекта.

