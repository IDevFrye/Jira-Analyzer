# Анализатор проектов JIRA
С полным отчётом можно ознакомиться по [ссылке](https://docs.google.com/document/d/162BJeFayohDZ95NqP_269i3AaB-a9TR3C3PmBbqqCkg/edit?usp=sharing).

## Состав команды:
- Костин Андрей Константинович ([@IDevFrye](https://github.com/IDevFrye)) - гр. 5130904/20101
- Мамонова Алина Сергеевна ([@hahapathetic](https://github.com/hahapathetic)) - гр. 5130904/20101
- Клеблеева Элина Маратовна ([@EmptyInsid](https://github.com/EmptyInsid)) - гр. 5130904/20105

## Этапы
### Проблема
Компании, использующие Jira, сталкиваются со сложностью получения сводной статистики и аналитики по своим проектам, особенно если речь идет о нескольких проектах одновременно. Отсутствует удобный инструмент, который позволял бы в едином интерфейсе сравнивать проекты, получать детальную аналитику по времени выполнения задач, динамике создания и закрытия тикетов, распределению задач по статусам, приоритетам и т.д. Для проектных офисов и аналитиков критично иметь такую информацию в удобном виде, чтобы принимать решения по управлению командами и процессами.

### Цель
Создать клиент-серверное приложение с микросервисной архитектурой для автоматизированного анализа задач из репозиториев Jira компании Apache с сохранением данных в PostgreSQL и предоставлением удобного веб-интерфейса для получения статистики, аналитики и сравнения проектов.

---

### Выработка требований

#### Пользовательские истории (User Story)
| Роль | Потребность |
|-------|-------------|
| US1 **Администратор** | Настройка списка отслеживаемых проектов |
| US2 **Менеджер проекта** | Получение сводной статистики по задачам |
| US3 **Руководитель** | Сравнение метрик нескольких проектов |

#### Функциональные требования:

**ФТ.1 - Статистика на странице "Мои проекты"**  
- Общее количество задач
- Количество открытых задач
- Количество закрытых задач
- Среднее время выполнения задачи (часы)
- Среднее количество заведенных задач в день за последнюю неделю

**ФТ.2 - Аналитические функции**  
У каждого проекта должна быть возможность выбора аналитических задач.
Аналитические задачи:
- Гистограмма времени в открытом состоянии
- Распределение времени по статусам
- График активности задач
- Анализ сложности задач
- Приоритетность всех/закрытых задач

#### Нефункциональные требования:

**Производительность**  
| Показатель | Значение | Обоснование |
|------------|----------|-------------|
| Throughput | 1000 RPS (read)<br>100 RPS (write) | Преобладание аналитических запросов |
| Latency | Чтение <200мс<br>Запись <500мс | Требования к отзывчивости UI |
| R/W Ratio | 90/10 | Преимущественно read-only нагрузка |

**Хранение данных**  
| Параметр | Значение | Детализация |
|----------|----------|-------------|
| Трафик | до 10 ГБ/сутки | 2-5 КБ/задача (Jira API) |
| Хранение | 100 ГБ/5 лет | 20-50 КБ/задача в БД |
| Логи | 20 ГБ/год | Аудит и мониторинг |

---

### Разработĸа архитеĸтуры и детальное проеĸтирование

**С4-диаграммы:**

![image](https://github.com/user-attachments/assets/34793fb9-8e0a-4fb5-b7b4-a8f29f106e75)
![image](https://github.com/user-attachments/assets/ac51b4c4-ec20-40f7-9c8d-1729b95fae2e)

**Ключевые компоненты:**
- Микросервисная архитектура (Jira Connector + Backend Endpoint Handler)
- PostgreSQL для хранения данных
- Client UI для отображения пользователю
- Redis для кэширования

**Характеристики нагрузки**  
- Соотношение R/W: 90%/10%
- Пиковый трафик: 10 ГБ/сутки
- Дисковое хранилище: 100 ГБ (основные данные) + 20 ГБ (логи)

**Требования к отклику**  
| Компонент | Операция | Макс. время |
|-----------|----------|-------------|
| API | GET-запросы | 100 мс |
| API | POST/PUT | 250 мс |
| БД | SELECT (индекс) | 50 мс |
| БД | JOIN агрегация | 400 мс |

**Масштабируемость:**
- Горизонтальное масштабирование БД
- Балансировка нагрузки через Nginx
- Очереди Kafka для фоновых задач

---

### Кодирование и отладĸа
**Технологический стек:**
- Backend: Go
- Frontend: React, TypeScript, SCSS
- База данных: PostgreSQL
- Инфраструктура: Docker

**Разработка велась в ветках:**
- `main` - основная ветка с релизом
- `develop-front` - ветка разработки клиентской части
- `backend` - ветка разработки серверной части (микросервис бэкенда, предоставляющий API фронтенду и обращающийся к БД и микросервису-коннектору)
- `jira-connector` - ветка разработки серверной части (микросервис бэкенда, предоставляющий API бэкенду и обращающийся к БД и внешнему API Jira)
- `devops` - ветка разработки конфигов и файлов для сборки, тестирования и развертывания проекта

Каждый участник сделал коммиты в данный проект. Подробнее - см. историю коммитов данного репозитория (по всем веткам).

---

### Unit/Интеграционное/Нагрузочное тестирование
- Unit-тесты: 80-100% покрытие ключевых модулей

| Модуль                        | Покрытие тестами       |
|-------------------------------|------------------------|
| JiraConnector/jiraHandlers    | 100.0% of statements   |
| JiraConnector/jiraService     | 100.0% of statements   |
| JiraConnector/connector       | 90.8% of statements    |
| JiraConnector/dataTransformer | 100.0% of statements   |
| JiraConnector/dbPusher        | 90.2% of statements    |
| endpointHandler/compare       | 81.3% of statements    |
| endpointHandler/handler       | 62.5% of statements    |
| endpointHandler/repository    | 72.7% of statements    |
| endpointHandler/service       | 81.5% of statements    |
| endpointHandler/analytics     | 80.0% of statements    |

- Интеграционные тесты: Полные пользовательские сценарии
![image](https://github.com/user-attachments/assets/25bc67ee-195b-4995-8a24-75c7be150f75)

- Нагрузочное тестирование: xk6 (до 1500 RPS)

| Метрика                   | Значение       | Комментарий                                                                 |
|---------------------------|----------------|-----------------------------------------------------------------------------|
| Всего запросов            | 372,869        | Хороший объём                                                               |
| Успешные проверки         | 98.57%         | Чуть ниже идеала (>99%), но приемлемо                                       |
| Ошибки (http_req_failed)  | 1.42%          | Стремиться к <1%, что приемлемо                                             |
| Dropped iterations        | 620,129 (!)    | Очень много — нехватка VU                                                   |
| Максимальный VU           | 1900           | Использованы все                                                            |
| Пиковая задержка (http_req_duration) | 95% ≤ 376ms | Приемлемо                                                                   |

---

### Сборка
Варианты запуска:
1. Использование Taskfile (рекомендуется)
```
# Основные команды:
task up               # Запуск всех сервисов в Docker
task down             # Остановка контейнеров
task clean            # Полная очистка системы
task logs             # Просмотр логов контейнеров
task db               # Подключение к консоли БД

# Тестирование:
task unit-test        # Запуск unit-тестов
task integration-test # Запуск интеграционных тестов
task all              # Полный пайплайн (сборка + тесты)
```
2. Использование Makefile (для Unix-систем)
```
# Основные команды:
make up               # Запуск всех сервисов
make down             # Остановка контейнеров
make clean            # Удаление контейнеров и томов
make logs             # Просмотр логов
make db               # Подключение к консоли БД

# Тестирование:
make unit-test        # Юнит-тесты
make integration-test # Интеграционные тесты
make all              # Полный пайплайн
```
3. Прямые команды Docker Compose
```
# Сборка и запуск
docker compose up --build -d

# Тестирование
docker compose run --rm backend go test ./... -v
docker compose run --rm jiraconnector go test ./... -v
docker compose run --rm jiraconnector go test ./tests/integration/... -v -tags=integration
docker compose run --rm backend-test

# Управление контейнерами
docker compose down              # Остановка
docker compose down -v --remove-orphans  # Полная очистка
docker compose logs -f           # Просмотр логов

# Работа с БД
docker exec -it deployment-postgres-1 psql -U postgres -d testdb
```

## Лицензия
Этот проект лицензирован по лицензии MIT — подробности см. в файле LICENSE.
